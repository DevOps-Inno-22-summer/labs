# Dry Run helm chart

    igni@igni:~/Documents/devops-labs/k8s$ ~/helm install --dry-run --debug app-python3 app-python

    install.go:178: [debug] Original chart version: ""
    install.go:195: [debug] CHART PATH: /home/igni/Documents/devops-labs/k8s/app-python

    NAME: app-python3
    LAST DEPLOYED: Tue Jul 12 02:09:45 2022
    NAMESPACE: default
    STATUS: pending-install
    REVISION: 1
    USER-SUPPLIED VALUES:
    {}

    COMPUTED VALUES:
    affinity: {}
    autoscaling:
    enabled: false
    maxReplicas: 100
    minReplicas: 1
    targetCPUUtilizationPercentage: 80
    fullnameOverride: ""
    image:
    pullPolicy: IfNotPresent
    repository: raminafandi/time-python
    tag: time-python
    imagePullSecrets: []
    ingress:
    annotations: {}
    className: ""
    enabled: false
    hosts:

    - host: chart-example.local
    paths: - path: /
    pathType: ImplementationSpecific
    tls: []
    nameOverride: ""
    nodeSelector: {}
    podAnnotations: {}
    podSecurityContext: {}
    replicaCount: 1
    resources: {}
    securityContext: {}
    service:
    port: 80
    type: ClusterIP
    serviceAccount:
    annotations: {}
    create: true
    name: ""
    tolerations: []

    ## HOOKS:

    # Source: app-python/templates/tests/test-connection.yaml

    apiVersion: v1
    kind: Pod
    metadata:
    name: "app-python3-test-connection"
    labels:
    helm.sh/chart: app-python-0.1.0
    app.kubernetes.io/name: app-python
    app.kubernetes.io/instance: app-python3
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
    annotations:
    "helm.sh/hook": test
    spec:
    containers: - name: wget
    image: busybox
    command: ['wget']
    args: ['app-python3:80']
    restartPolicy: Never
    MANIFEST:

    ---

    # Source: app-python/templates/serviceaccount.yaml

    apiVersion: v1
    kind: ServiceAccount
    metadata:
    name: app-python3
    labels:
    helm.sh/chart: app-python-0.1.0
    app.kubernetes.io/name: app-python
    app.kubernetes.io/instance: app-python3
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm

    ---

    # Source: app-python/templates/config.yaml

    apiVersion: v1
    kind: ConfigMap
    metadata:
    name: app-python3-configmap
    labels:
    app: app-python3
    chart: app-python-0.1.0
    data:
    config.json:
    '{
    "user": "Heisenberg"
    }
    '

    ---

    # Source: app-python/templates/service.yaml

    apiVersion: v1
    kind: Service
    metadata:
    name: app-python3
    labels:
    helm.sh/chart: app-python-0.1.0
    app.kubernetes.io/name: app-python
    app.kubernetes.io/instance: app-python3
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
    spec:
    type: ClusterIP
    ports: - port: 80
    targetPort: http
    protocol: TCP
    name: http
    selector:
    app.kubernetes.io/name: app-python
    app.kubernetes.io/instance: app-python3

    ---

    # Source: app-python/templates/deployment.yaml

    apiVersion: apps/v1
    kind: Deployment
    metadata:
    name: app-python3
    labels:
    helm.sh/chart: app-python-0.1.0
    app.kubernetes.io/name: app-python
    app.kubernetes.io/instance: app-python3
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
    spec:
    replicas: 1
    selector:
    matchLabels:
    app.kubernetes.io/name: app-python
    app.kubernetes.io/instance: app-python3
    template:
    metadata:
    labels:
    app.kubernetes.io/name: app-python
    app.kubernetes.io/instance: app-python3
    spec:
    serviceAccountName: app-python3
    volumes: - name: config-volume
    configMap:
    name: app-python3-configmap
    securityContext:
    {}
    containers: - name: app-python
    securityContext:
    {}
    image: "raminafandi/time-python:time-python"
    imagePullPolicy: IfNotPresent
    env: - name: MY_PASSWORD
    valueFrom:
    secretKeyRef:
    name: credentials
    key: password
    volumeMounts: - name: config-volume
    mountPath: /files/config.json
    subPath: config.json
    ports: - name: http
    containerPort: 5000
    protocol: TCP
    livenessProbe:
    httpGet:
    path: /
    port: http
    readinessProbe:
    httpGet:
    path: /
    port: http
    resources:
    {}

    NOTES:

    1. Get the application URL by running these commands:
    export POD_NAME=$(kubectl get pods --namespace default -l "app.kubernetes.io/name=app-python,app.kubernetes.io/instance=app-python3" -o jsonpath="{.items[0].metadata.name}")
    export CONTAINER_PORT=$(kubectl get pod --namespace default $POD_NAME -o jsonpath="{.spec.containers[0].ports[0].containerPort}")
    echo "Visit http://127.0.0.1:8080 to use your application"
    kubectl --namespace default port-forward $POD_NAME 8080:$CONTAINER_PORT

# Result of kubectl get po,sts,svc,pvc

    igni@igni:~/Documents/devops-labs/k8s$ kubectl get po,sts,svc,pvc
    NAME                                READY   STATUS    RESTARTS       AGE
    pod/app-app-python-5f6678bc-2tk8c   1/1     Running   1 (4h1m ago)   5d9h
    pod/app-python-2-5499797494-n48m8   1/1     Running   0              3h34m
    pod/app-python-3-8599bb97dd-p2krz   1/1     Running   0              12m
    pod/app-python-fdb5b9864-trfvk      1/1     Running   1 (4h1m ago)   5d8h
    pod/time-python-0                   1/1     Running   0              3h58m
    pod/time-python-1                   1/1     Running   0              3h58m
    pod/time-python-2                   1/1     Running   0              3h58m

    NAME                           READY   AGE
    statefulset.apps/time-python   3/3     3h58m

    NAME                     TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)   AGE
    service/app-app-python   ClusterIP   10.97.20.34      <none>        80/TCP    5d9h
    service/app-python       ClusterIP   10.103.125.20    <none>        80/TCP    5d8h
    service/app-python-2     ClusterIP   10.96.250.210    <none>        80/TCP    3h34m
    service/app-python-3     ClusterIP   10.103.218.166   <none>        80/TCP    12m
    service/kubernetes       ClusterIP   10.96.0.1        <none>        443/TCP   5d9h

    NAME                                      STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
    persistentvolumeclaim/www-time-python-0   Bound    pvc-208a9d21-4669-400c-9e48-253f4ee83dda   1Gi        RWO            standard       3h58m
    persistentvolumeclaim/www-time-python-1   Bound    pvc-e8f0aa5e-f414-45c6-a83c-d0a275511679   1Gi        RWO            standard       3h58m
    persistentvolumeclaim/www-time-python-2   Bound    pvc-247d5c5d-7459-4a48-a5d9-b21832446c49   1Gi        RWO            standard       3h58m
